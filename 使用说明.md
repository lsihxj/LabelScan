# 电子标签多条码识别系统 - Windows独立部署版使用说明

## 📋 目录

1. [系统简介](#系统简介)
2. [快速开始](#快速开始)
3. [构建发布包](#构建发布包)
4. [部署到目标机器](#部署到目标机器)
5. [使用指南](#使用指南)
6. [常见问题](#常见问题)

---

## 系统简介

电子标签多条码识别系统是一个高性能的图像识别解决方案，支持：

- ✅ 多种条码识别（二维码、条形码等）
- ✅ OCR文字识别（本地Tesseract或云端API）
- ✅ AI智能识别（支持多个AI服务商）
- ✅ 智能排序（按阅读顺序、从上到下、从左到右）
- ✅ Web界面操作
- ✅ 移动端支持（拍照识别）
- ✅ 批量处理

---

## 快速开始

### 开发模式

如果你是开发者，想在本地运行和调试：

1. **双击运行**: `快速启动(开发).bat`
2. **打开浏览器**: http://localhost:8000
3. **开始使用**

开发模式会自动安装依赖并启动热重载服务。

### 配置检查

首次运行前，建议执行配置检查：

**双击运行**: `配置检查.bat`

该工具会自动：
- 检查Python版本
- 检测Tesseract OCR
- 更新配置文件
- 创建必要目录

---

## 构建发布包

### 一键构建（推荐）

**双击运行**: `一键构建.bat`

脚本会自动完成所有构建步骤，最终生成可分发的独立部署包。

### 手动构建

如果需要更多控制：

```bash
# 1. 安装构建依赖
pip install -r build_requirements.txt

# 2. 构建前端
cd frontend
npm install
npm run build
cd ..

# 3. 打包
python build_windows.py
```

### 构建产物

构建完成后会生成：

```
dist/LabelScan/                        # 完整应用程序目录
release/LabelScan_Windows_v1.0.0.zip  # 可分发的压缩包
```

---

## 部署到目标机器

### 系统要求

**必需**:
- Windows 10/11 (64位)
- Tesseract OCR 5.3+

**可选**:
- Redis (用于缓存)

### 部署步骤

#### 1️⃣ 解压程序包

将 `LabelScan_Windows_v1.0.0.zip` 解压到任意目录，例如：
```
D:\LabelScan\
```

#### 2️⃣ 安装Tesseract OCR

**下载地址**: https://github.com/UB-Mannheim/tesseract/wiki

**安装步骤**:
1. 下载Windows安装包（推荐64位）
2. 运行安装程序
3. **重要**: 勾选中文语言包 `Chinese - Simplified (chi_sim)`
4. 完成安装，记住安装路径

默认安装路径通常为：
```
C:\Program Files\Tesseract-OCR\tesseract.exe
```

#### 3️⃣ 配置Tesseract路径

编辑 `config\system.yaml`，找到以下配置：

```yaml
ocr:
  local:
    tesseract_cmd: "C:\\Program Files\\Tesseract-OCR\\tesseract.exe"
    lang: "eng+chi_sim"
```

将 `tesseract_cmd` 修改为实际安装路径。

**注意**: Windows路径中的反斜杠需要使用双反斜杠 `\\`

#### 4️⃣ 启动系统

双击运行 `start.bat`

启动成功后会显示：
```
========================================
  电子标签多条码识别系统
========================================

正在启动服务器...

INFO:     Started server process
INFO:     Uvicorn running on http://0.0.0.0:8000
```

#### 5️⃣ 访问系统

在浏览器中打开：
- **主界面**: http://localhost:8000
- **API文档**: http://localhost:8000/docs

---

## 使用指南

### Web界面操作

#### 1. 上传图像

- **PC端**: 点击上传区域选择图片
- **移动端**: 可选择"拍照"或"从相册选择"

#### 2. 选择识别模式

- **仅条码**: 只识别条码/二维码
- **仅文字**: 只进行OCR文字识别
- **条码+文字**: 同时识别条码和文字
- **AI识别**: 使用AI模型智能识别

#### 3. 选择处理模式

- **极速模式**: 快速处理，适合批量扫描
- **均衡模式**: 平衡速度和准确度（推荐）
- **完整模式**: 最高准确度，处理速度较慢

#### 4. 查看结果

识别完成后会显示：
- 识别到的条码和文字
- 按阅读顺序排列的结果
- 处理时间统计

### AI配置

如需使用AI识别功能：

1. 点击界面上的"AI设置"按钮
2. 添加AI服务商配置
3. 配置API密钥
4. 选择模型
5. 激活模型

支持的AI服务商：
- OpenAI
- Moonshot (月之暗面)
- 其他兼容OpenAI格式的服务

### 拍照设置（移动端）

移动端支持拍照后自动旋转图像：

1. 首次拍照后选择旋转角度
2. 系统会记住您的选择
3. 下次拍照时自动应用该设置

旋转选项：
- 不旋转
- 向左旋转90度
- 向右旋转90度

---

## 常见问题

### 启动相关

**Q: 启动失败，提示端口被占用**

A: 端口8000已被其他程序使用。解决方法：
- 关闭占用端口的程序
- 或修改 `config/system.yaml` 中的端口号

**Q: 启动后浏览器无法访问**

A: 检查：
- 防火墙是否拦截
- 服务器是否成功启动（查看控制台输出）
- 访问地址是否正确

### OCR识别相关

**Q: OCR识别失败或报错**

A: 
1. 确认Tesseract已正确安装
2. 检查 `config/system.yaml` 中的路径配置
3. 确保中文语言包已安装
4. 查看 `logs/error.log` 了解详细错误

**Q: OCR识别效果差**

A:
1. 尝试使用"完整模式"
2. 确保图片清晰，分辨率足够
3. 检查图片方向是否正确

### 前端相关

**Q: 前端页面无法加载或显示空白**

A:
- 确认 `frontend/dist` 目录存在且完整
- 重新构建前端: `cd frontend && npm run build`
- 检查浏览器控制台的错误信息

**Q: 移动端无法访问摄像头**

A:
- 确保使用HTTPS连接（本地localhost除外）
- 检查浏览器权限设置
- 某些浏览器不支持此功能，建议使用Chrome

### AI识别相关

**Q: AI识别不可用**

A:
1. 检查网络连接
2. 确认API密钥配置正确
3. 检查API额度是否充足
4. 查看 `logs/app.log` 了解详细信息

**Q: AI识别速度慢**

A:
- 选择性能更好的模型
- 检查网络连接质量
- 考虑调整温度参数

### 配置相关

**Q: 修改配置后不生效**

A:
- 重启服务器
- 检查配置文件格式是否正确（YAML格式）
- 查看日志确认是否有配置错误

**Q: 如何重置配置**

A:
- 从 `config` 目录删除对应的YAML文件
- 重启系统会生成默认配置

---

## 技术支持

### 日志文件

遇到问题时，请查看日志：
- `logs/app.log` - 应用日志
- `logs/error.log` - 错误日志

### 配置文件

所有配置位于 `config` 目录：
- `system.yaml` - 系统配置
- `processing.yaml` - 处理参数
- `ai.yaml` - AI服务配置
- `logging.yaml` - 日志配置

### 获取帮助

1. 查看日志文件
2. 参考本文档
3. 查看 `快速构建指南.md`
4. 访问 http://localhost:8000/docs 查看API文档

---

## 附录

### 文件结构

```
LabelScan/
├── LabelScan.exe           # 主程序
├── start.bat               # 启动脚本
├── README_部署说明.txt      # 部署说明
├── config/                 # 配置文件目录
│   ├── system.yaml
│   ├── processing.yaml
│   ├── ai.yaml
│   └── logging.yaml
├── frontend/               # 前端文件
│   └── dist/
├── logs/                   # 日志目录
├── temp/                   # 临时文件
└── uploads/                # 上传文件
```

### 快捷键

在Web界面中：
- `Ctrl+V` - 粘贴图片上传
- `Esc` - 关闭弹窗

### 性能优化

1. **提高识别速度**:
   - 使用"极速模式"
   - 降低图片分辨率
   - 关闭不需要的识别功能

2. **提高识别准确度**:
   - 使用"完整模式"
   - 使用高质量图片
   - 确保图片方向正确

3. **降低资源占用**:
   - 关闭不需要的日志
   - 清理临时文件
   - 使用本地OCR而非AI识别

---

**版本**: 1.0.0  
**最后更新**: 2024-11
